services:
  api:
    build: .
    image: ghcr.io/canaria3406/ermiana:latest
    container_name: ermiana-api
    command: ["npm", "run", "start:api"]
    env_file:
      - .env
    environment:
      API_PORT: ${API_PORT:-3000}
      API_PUBLIC_URL: ${API_PUBLIC_URL:-http://api:3000}
      NODE_ENV: ${NODE_ENV:-production}
    ports:
      - "3000:3000"
    restart: unless-stopped

  bot:
    build: .
    image: ghcr.io/canaria3406/ermiana:latest
    container_name: ermiana-bot
    command: ["npm", "run", "start:bot"]
    env_file:
      - .env
    environment:
      BOT_USE_API_URL: ${BOT_USE_API_URL:-http://api:3000}
      NODE_ENV: ${NODE_ENV:-production}
    depends_on:
      - api
    restart: unless-stopped

networks:
  default:
    name: ermiana-net
